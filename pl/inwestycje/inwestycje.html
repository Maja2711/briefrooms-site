<section id="spx-scenarios" class="container my-5">
  <h2 class="mb-3">Scenariusze S&amp;P 500 – 1M / 6M / 12M w późnej fazie cyklu</h2>

  <p class="text-muted">
    Ten materiał przedstawia bazowe, ilustracyjne scenariusze zachowania indeksu S&amp;P 500
    w horyzoncie 1 miesiąca, 6 miesięcy i 12 miesięcy. Scenariusze oparte są na:
    prognozach wzrostu i inflacji (IMF/OECD), konsensusie dużych domów inwestycyjnych (GS, MS, UBS, Evercore),
    polityce banków centralnych (Fed, EBC) oraz historycznych analogiach (późne fazy hossy – dot-com,
    „roaring twenties”). Uwzględniamy także czynniki płynnościowe: poziomy SOFR oraz zmienność salda TGA
    (Treasury General Account) i bilansu Fed, które w 2025 r. istotnie wpływają na warunki finansowe.
  </p>
  <p class="text-muted">
    Wszystkie wykresy mają charakter hipotetyczny i edukacyjny. Nie są to rekomendacje inwestycyjne
    ani gwarancja przyszłych wyników. Poziomy „stref kupna” i „stref wysokich wycen/sprzedaży” są
    orientacyjne, oparte na prostych założeniach technicznych (odniesienie do średnich MA30/60/100)
    oraz na aktualnym poziomie indeksu w dniu 19.11.2025 (ok. 6617 pkt).
  </p>

  <!-- 1M -->
  <article class="mb-5">
    <h3 class="h5 mb-2">1. Horyzont 1 miesiąca – scenariusz taktyczny i płynność (SOFR / TGA)</h3>
    <p>
      W krótkim terminie S&amp;P 500 wszedł w fazę podwyższonej zmienności. Indeks po raz pierwszy
      od kilkudziesięciu sesji zamknął się poniżej 50-sesyjnej średniej kroczącej, co historycznie
      często prowadzi do korekty rzędu kilku–kilkunastu procent, ale nie musi od razu oznaczać końca
      całej hossy.
    </p>
    <p>
      Z punktu widzenia pozycjonowania ważne są strategie trend-following (CTA) – po złamaniu
      momentum modele ilościowe zwykle redukują pozycje długie na indeksach, generując mechaniczny
      strumień podaży w horyzoncie 1–4 tygodni. Dodatkowo w 2025 r. na krótkoterminową zmienność
      silnie wpływa „plumbing” rynku:
      budowa salda TGA przez Departament Skarbu (często w okolice 1 bln USD) oraz związane z tym
      ściąganie rezerw bankowych z bilansu Fed. W praktyce oznacza to chwilowe zacieśnienie
      warunków finansowania, szerszy rozkład SOFR i większą podatność na „air pocket” – nagłe,
      krótkotrwałe spadki cen aktywów ryzykownych.
    </p>
    <p>
      <strong>Scenariusz bazowy (1M):</strong>
      korekta i podwyższona zmienność w ramach wciąż trwającego rynku byka, napędzana mixem:
      techniki (50dma, CTA), wysokich wycen oraz czynników płynnościowych (TGA, SOFR).
      Przestrzelenia intraday poniżej typowych stref wsparcia są bardziej prawdopodobne niż
      w „czysto technicznym” środowisku.
    </p>
    <p>
      <strong>Strefy techniczne (1M, orientacyjne):</strong><br>
      – strefa potencjalnego kupna:
      <span class="text-success">6350–6450 pkt</span>
      (korekta rzędu ~3–4% od poziomu ok. 6617 pkt, zbliżona do strefy MA30–60 w środowisku bez recesji),<br>
      – strefa potencjalnej sprzedaży:
      <span class="text-danger">6850–6950 pkt</span>
      (obszar nieco powyżej ostatnich szczytów, gdzie naturalna jest realizacja zysków w krótkim terminie).
    </p>

    <canvas id="spxChart1m" style="width: 100%; height: 320px;"></canvas>
  </article>

  <!-- 6M -->
  <article class="mb-5">
    <h3 class="h5 mb-2">2. Horyzont 6 miesięcy – do połowy 2026 r. (makro, AI i koniec zacieśniania)</h3>
    <p>
      W horyzoncie około pół roku kluczowe znaczenie ma otoczenie makro i polityka stóp.
      Prognozy IMF/OECD wskazują na umiarkowany, ale dodatni wzrost gospodarki światowej
      (ok. 3,1–3,2% rocznie w 2025–2026), przy stopniowo opadającej inflacji.
      Fed i EBC są po szczycie cyklu podwyżek i przechodzą do fazy stopniowych obniżek stóp,
      sprowadzając je raczej w okolice poziomów „neutralnych” niż zera.
    </p>
    <p>
      Duże domy inwestycyjne (Goldman Sachs, Morgan Stanley, UBS, Evercore) w scenariuszu bazowym
      zakładają, że rok 2026 będzie nadal dobry dla aktywów ryzykownych – widzą potencjał
      S&amp;P 500 w okolice 7500–7800 pkt, oparty na wzroście zysków (EPS) oraz inwestycjach
      związanych z AI, obronnością i transformacją energetyczną. Jednocześnie podkreślają
      wysokie wyceny, koncentrację kapitalizacji w kilku spółkach oraz ryzyko korekt 10–20%
      po drodze.
    </p>
    <p>
      Ważny jest też wątek płynnościowy: w miarę wygaszania QT oraz stabilizacji TGA
      (mniejsza zmienność salda, stabilniejsze rezerwy bankowe) warunki finansowe mogą
      się poprawić w sposób, który sprzyja stopniowemu „wychodzeniu w górę” z korekty.
      Historycznie fazy poprawy rezerw po szokach TGA zbiegały się często z lepszymi
      okresami dla indeksów akcyjnych.
    </p>
    <p>
      <strong>Scenariusz bazowy (6M):</strong>
      po krótkoterminowej korekcie rynek stopniowo wraca do umiarkowanego trendu
      wzrostowego. Indeks ma szansę wrócić w okolice szczytów lub lekko je przebić,
      ale rozkład ryzyka (relacja potencjalny zysk / potencjalny drawdown) jest
      mniej korzystny niż kilka lat temu.
    </p>
    <p>
      <strong>Strefy techniczne (6M, orientacyjne):</strong><br>
      – strefa potencjalnego kupna:
      <span class="text-success">5900–6100 pkt</span>
      (głębsza korekta rzędu ~8–12%, zbliżona do dłuższych średnich MA60–100
      w scenariuszu bez ostrej recesji),<br>
      – strefa potencjalnej sprzedaży:
      <span class="text-danger">7100–7300 pkt</span>
      (obszar nowych szczytów, w którym wyceny są bardzo napięte,
      a ryzyko większej korekty znacząco rośnie).
    </p>

    <canvas id="spxChart6m" style="width: 100%; height: 320px;"></canvas>
  </article>

  <!-- 12M -->
  <article class="mb-5">
    <h3 class="h5 mb-2">3. Horyzont 12 miesięcy – do końca 2026 r. (późna hossa i „ogon bańki”)</h3>
    <p>
      W horyzoncie roku najważniejsze jest pytanie, jak długo da się utrzymać
      obecne kombinacje: umiarkowany wzrost PKB (~3%), inflacja blisko, ale często
      nieco powyżej celu, stopy na poziomie neutralnym (Fed w okolicach 3–3,5%,
      EBC ok. 2%) oraz bardzo wysokie wyceny akcji, szczególnie w USA.
    </p>
    <p>
      IMF i banki centralne sygnalizują, że świat nie wraca do „tanich pieniędzy”
      sprzed 2008 r. – obligacje znów stanowią realną alternatywę dla akcji.
      Z kolei raporty zgodnie wskazują na rekordową koncentrację kapitalizacji
      w kilku spółkach AI i na wyceny S&amp;P 500 w górnych percentylach historycznych.
      Evercore porównuje obecną sytuację do późnej fazy dot-com: realny,
      silny trend technologiczny + narastające ryzyko „bańki”.
    </p>
    <p>
      Konsensus dużych domów inwestycyjnych (UBS, MS, Evercore) ustawia swoje
      bazowe targety na koniec 2026 r. mniej więcej w przedziale 7500–7800 pkt.
      Evercore dopuszcza „ogon bańki” – scenariusz typu ~9000 pkt przy sprzyjającej
      kombinacji: dalszy spadek krótkoterminowych stawek (SOFR), stabilizacja TGA,
      mocny przepływ kapitału do AI i brak poważnej reakcji regulatorów.
      Rynek byłby wtedy ewidentnie w fazie „big beautiful bubble”.
    </p>
    <p>
      <strong>Scenariusz bazowy (12M):</strong>
      S&amp;P 500 kończy 2026 r. nominalnie wyżej niż dziś, realne stopy zwrotu są
      dodatnie, ale umiarkowane, a po drodze pojawia się co najmniej jedna większa
      korekta rzędu 15–25%. Nie zakładamy z góry końca hossy do końca 2026 r.,
      ale podkreślamy, że relacja potencjalnego zysku „dalej w górę” do ryzyka
      większej bessy systematycznie się pogarsza.
    </p>
    <p>
      <strong>Strefy techniczne (12M, orientacyjne):</strong><br>
      – strefa potencjalnego kupna:
      <span class="text-success">5500–5700 pkt</span>
      (głębsza, cykliczna korekta – ok. −15% od dzisiejszych poziomów,
      ale wciąż zgodna z późnocyklicznym scenariuszem bez ostrej recesji),<br>
      – strefa <em>bardzo wysokich wycen</em> / redukcji ryzyka:
      <span class="text-danger">7400–7600 pkt</span>
      (późnocykliczny „sufit”, w pobliżu którego konsensus ustawia swoje bazowe
      targety; raczej strefa świadomego ograniczania ryzyka niż „twardy sygnał
      wszystko sprzedać”).
    </p>

    <canvas id="spxChart12m" style="width: 100%; height: 320px;"></canvas>
  </article>

  <!-- Zakładki z wynikami weryfikacji scenariuszy -->
  <section class="mb-5">
    <h3 class="h5 mb-3">Weryfikacja scenariuszy – wyniki w czasie</h3>
    <p class="text-muted">
      Poniższe zakładki są miejscem na uzupełnienie rzeczywistych wyników po 1M, 6M i 12M:
      czy doszło do wejścia/wyjścia z pozycji w oparciu o opisane strefy oraz jaki był wynik
      operacji (lub wynik z trzymania pozycji). Dane mogą być wypełniane ręcznie po upływie
      danego horyzontu czasowego.
    </p>

    <ul class="nav nav-tabs" id="spxResultsTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active"
                id="result-1m-tab"
                data-bs-toggle="tab"
                data-bs-target="#result-1m"
                type="button"
                role="tab"
                aria-controls="result-1m"
                aria-selected="true">
          Wynik po 1M
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link"
                id="result-6m-tab"
                data-bs-toggle="tab"
                data-bs-target="#result-6m"
                type="button"
                role="tab"
                aria-controls="result-6m"
                aria-selected="false">
          Wynik po 6M
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link"
                id="result-12m-tab"
                data-bs-toggle="tab"
                data-bs-target="#result-12m"
                type="button"
                role="tab"
                aria-controls="result-12m"
                aria-selected="false">
          Wynik po 12M
        </button>
      </li>
    </ul>

    <div class="tab-content border border-top-0 p-3" id="spxResultsTabsContent">
      <!-- 1M -->
      <div class="tab-pane fade show active" id="result-1m" role="tabpanel" aria-labelledby="result-1m-tab">
        <p class="text-muted">
          Do uzupełnienia po upływie ~1 miesiąca od daty odniesienia (19.11.2025).
          Można tu wpisać, czy nastąpiło wejście/wyjście z pozycji oraz jaki był wynik.
        </p>
        <div class="table-responsive">
          <table class="table table-sm align-middle">
            <thead>
              <tr>
                <th>Data decyzji</th>
                <th>Typ decyzji</th>
                <th>Poziom S&amp;P 500</th>
                <th>Data zamknięcia / status</th>
                <th>Poziom wyjścia</th>
                <th>Wynik %</th>
                <th>Uwagi</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="7" class="text-muted">
                  Brak danych – do uzupełnienia po 1M.
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 6M -->
      <div class="tab-pane fade" id="result-6m" role="tabpanel" aria-labelledby="result-6m-tab">
        <p class="text-muted">
          Do uzupełnienia po upływie ~6 miesięcy. Można odnotować wynik strategii
          opartej na strefach technicznych (kupno w strefie zielonej, redukcja w strefie czerwonej).
        </p>
        <div class="table-responsive">
          <table class="table table-sm align-middle">
            <thead>
              <tr>
                <th>Data wejścia</th>
                <th>Poziom wejścia</th>
                <th>Data wyjścia / status</th>
                <th>Poziom wyjścia</th>
                <th>Wynik %</th>
                <th>Uwagi (np. częściowe wyjścia, brak transakcji)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="6" class="text-muted">
                  Brak danych – do uzupełnienia po 6M.
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 12M -->
      <div class="tab-pane fade" id="result-12m" role="tabpanel" aria-labelledby="result-12m-tab">
        <p class="text-muted">
          Do uzupełnienia po upływie ~12 miesięcy. Warto tutaj zestawić rzeczywisty przebieg
          indeksu z opisanym scenariuszem „późnej hossy” oraz sprawdzić, czy wejście/wyjście
          w strefach kupna i bardzo wysokich wycen było korzystne.
        </p>
        <div class="table-responsive">
          <table class="table table-sm align-middle">
            <thead>
              <tr>
                <th>Data wejścia</th>
                <th>Poziom wejścia</th>
                <th>Data wyjścia / status</th>
                <th>Poziom wyjścia</th>
                <th>Wynik %</th>
                <th>Komentarz (np. realizacja zysków, dalsze trzymanie)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="6" class="text-muted">
                  Brak danych – do uzupełnienia po 12M.
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </section>
</section>

<!-- Chart.js z CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

<script type="module">
  // Parametry odniesienia
  const ANCHOR_DATE  = '2025-11-19';   // data kotwicy
  const ANCHOR_LEVEL = 6617.32;        // poziom S&P 500 w dacie kotwicy

  function createDateRange(startStr, endStr) {
    const start = new Date(startStr);
    const end   = new Date(endStr);
    const dates = [];
    let d = new Date(start);
    while (d <= end) {
      dates.push(new Date(d));
      d.setDate(d.getDate() + 1);
    }
    return dates;
  }

  // Losowa, hipotetyczna ścieżka S&P 500 z lekkim trendem, zakotwiczona na ANCHOR_LEVEL
  function generateSpxPath(dates, anchorDateStr, anchorLevel) {
    const n = dates.length;
    const dailyVol = 20;
    const drift    = 0.3;
    const series   = new Array(n);

    series[0] = 0;
    for (let i = 1; i < n; i++) {
      const shock = (Math.random() - 0.5) * 2 * dailyVol;
      series[i] = series[i - 1] + shock + drift;
    }

    const anchorIndex = dates.findIndex(
      d => d.toISOString().slice(0, 10) === anchorDateStr
    );
    const anchorValue = anchorIndex >= 0 ? series[anchorIndex] : series[Math.floor(n / 2)];
    const offset      = anchorLevel - anchorValue;

    return series.map(v => v + offset);
  }

  function createSpxChart(canvasId, config) {
    const canvas = document.getElementById(canvasId);
    if (!canvas) return;
    const ctx = canvas.getContext('2d');

    const dates  = createDateRange(config.startDate, config.endDate);
    const spx    = generateSpxPath(dates, ANCHOR_DATE, ANCHOR_LEVEL);
    const labels = dates.map(d => d.toISOString().slice(0, 10));

    new Chart(ctx, {
      type: 'line',
      data: {
        labels,
        datasets: [
          {
            label: 'S&P 500 (hipotetyczna ścieżka)',
            data: spx,
            borderColor: 'rgba(218, 165, 32, 1)',   // złoty/żółty
            backgroundColor: 'rgba(218, 165, 32, 0.08)',
            borderWidth: 2,
            tension: 0.25,
            pointRadius: 0
          },
          // Strefa kupna – dolna i górna (zielone)
          {
            label: 'Dolna granica strefy kupna',
            data: labels.map(() => config.buyLow),
            borderColor: 'rgba(0, 128, 0, 1)',
            borderWidth: 1.5,
            borderDash: [6, 4],
            pointRadius: 0,
            fill: false
          },
          {
            label: 'Górna granica strefy kupna',
            data: labels.map(() => config.buyHigh),
            borderColor: 'rgba(0, 160, 0, 1)',
            borderWidth: 1.5,
            borderDash: [2, 4],
            pointRadius: 0,
            fill: false
          },
          // Strefa sprzedaży / wysokich wycen – dolna i górna (czerwone)
          {
            label: 'Dolna granica strefy sprzedaży / wysokich wycen',
            data: labels.map(() => config.sellLow),
            borderColor: 'rgba(200, 0, 0, 1)',
            borderWidth: 1.5,
            borderDash: [6, 4],
            pointRadius: 0,
            fill: false
          },
          {
            label: 'Górna granica strefy sprzedaży / wysokich wycen',
            data: labels.map(() => config.sellHigh),
            borderColor: 'rgba(255, 0, 0, 1)',
            borderWidth: 1.5,
            borderDash: [2, 4],
            pointRadius: 0,
            fill: false
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        interaction: {
          mode: 'index',
          intersect: false
        },
        plugins: {
          legend: {
            position: 'top',   // u góry
            align: 'start',    // LEWY górny róg
            labels: {
              boxWidth: 18
            }
          },
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toFixed(0)} pkt`
            }
          }
        },
        scales: {
          x: {
            title: {
              display: true,
              text: 'Data kalendarzowa'
            },
            ticks: {
              maxRotation: 0,
              autoSkip: true,
              maxTicksLimit: 8
            }
          },
          y: {
            title: {
              display: true,
              text: 'Poziom S&P 500 (punkty)'
            }
          }
        }
      }
    });
  }

  // 1M – ok. 30 dni wstecz i 30 dni w przód
  createSpxChart('spxChart1m', {
    startDate: '2025-10-20',
    endDate:   '2025-12-19',
    buyLow:  6350,
    buyHigh: 6450,
    sellLow: 6850,
    sellHigh:6950
  });

  // 6M – ok. 60 dni wstecz i ~6 miesięcy w przód
  createSpxChart('spxChart6m', {
    startDate: '2025-09-20',
    endDate:   '2026-05-19',
    buyLow:  5900,
    buyHigh: 6100,
    sellLow: 7100,
    sellHigh:7300
  });

  // 12M – ok. 90 dni wstecz i ~12 miesięcy w przód
  createSpxChart('spxChart12m', {
    startDate: '2025-08-21',
    endDate:   '2026-11-19',
    buyLow:  5500,
    buyHigh: 5700,
    sellLow: 7400,
    sellHigh:7600
  });
</script>

